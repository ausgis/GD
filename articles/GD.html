<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Optimal Parameters-based Geographical Detectors (OPGD) Model for Spatial Heterogeneity Analysis and Factor Exploration • GD</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Parameters-based Geographical Detectors (OPGD) Model for Spatial Heterogeneity Analysis and Factor Exploration">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">10.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/GD.html">Optimal Parameters-based Geographical Detectors (OPGD) Model for Spatial Heterogeneity Analysis and Factor Exploration</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ausgis/GD/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Optimal Parameters-based Geographical Detectors (OPGD) Model for Spatial Heterogeneity Analysis and Factor Exploration</h1>
                        <h4 data-toc-skip class="author">Yongze
Song</h4>
            
            <h4 data-toc-skip class="date">2024-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ausgis/GD/blob/main/vignettes/GD.Rmd" class="external-link"><code>vignettes/GD.Rmd</code></a></small>
      <div class="d-none name"><code>GD.Rmd</code></div>
    </div>

    
    
<p> </p>
<p><code>Current version: GD v10.5</code></p>
<p> </p>
<div class="section level3">
<h3 id="citation-for-package-gd">Citation for package <code>GD</code><a class="anchor" aria-label="anchor" href="#citation-for-package-gd"></a>
</h3>
<p>To cite <strong><code>GD</code> R package</strong> in publications,
please use:</p>
<p><strong>Song, Y., Wang, J., Ge, Y. &amp; Xu, C. (2020) “An optimal
parameters-based geographical detector model enhances geographic
characteristics of explanatory variables for spatial heterogeneity
analysis: Cases with different types of spatial data”, GIScience &amp;
Remote Sensing. 57(5), 593-610. doi: <a href="https://doi.org/10.1080/15481603.2020.1760434" class="external-link">10.1080/15481603.2020.1760434</a>.</strong></p>
<p> </p>
</div>
<div class="section level3">
<h3 id="authors-affiliations">Authors’ affiliations<a class="anchor" aria-label="anchor" href="#authors-affiliations"></a>
</h3>
<p><strong>Dr. Yongze Song</strong></p>
<p><a href="https://scholar.google.com.au/citations?user=bNuxvgIAAAAJ&amp;hl=en&amp;oi=ao" class="external-link">Google
Scholar</a>, <a href="https://www.researchgate.net/profile/Yongze-Song" class="external-link">ResearchGate</a></p>
<p>Research interests: Spatial statistics, sustainable
infrastructure</p>
<p>Curtin University, Australia</p>
<p>Email: <a href="mailto:yongze.song@curtin.edu.au" class="email">yongze.song@curtin.edu.au</a></p>
<p> </p>
</div>
<div class="section level2">
<h2 id="introduction-to-gd-package">1. Introduction to <code>GD</code> package<a class="anchor" aria-label="anchor" href="#introduction-to-gd-package"></a>
</h2>
<div class="section level3">
<h3 id="the-model-can-be-used-to-address-following-issues">1.1 The model can be used to address following issues:<a class="anchor" aria-label="anchor" href="#the-model-can-be-used-to-address-following-issues"></a>
</h3>
<ul>
<li><p>Explore potential factors or explanatory variables from a spatial
perspective.</p></li>
<li><p>Explore potential interactive impacts of geogrpahical
variables.</p></li>
<li><p>Identify high-risk or low-risk regions from potential explanatory
variables.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="the-gd-package-makes-following-steps-fast-and-easy">1.2 The <code>GD</code> package makes following steps fast and
easy:<a class="anchor" aria-label="anchor" href="#the-gd-package-makes-following-steps-fast-and-easy"></a>
</h3>
<ul>
<li><p>It contains both supervised and unsupervised spatial data
discretization methods, and the optimal spatial discretization method
for continuous variables;</p></li>
<li><p>It contains four primary functions of geographical detectors,
including factor detector, risk detector, interaction detector and
ecological detector;</p></li>
<li><p>It can be used to compare size effects of spatial unit;</p></li>
<li><p>It provides diverse visualizations of spatial analysis
results;</p></li>
<li><p>It contains detailed significance tests for spatial analysis in
each step of geographical detectors.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="start-from-the-one-step-function-gdm-highly-recommended">1.3 Start from the <em>one-step function</em>: <code>gdm</code>
(<em>Highly Recommended</em>)<a class="anchor" aria-label="anchor" href="#start-from-the-one-step-function-gdm-highly-recommended"></a>
</h3>
<p>The pacakge provides a one-step function for performing optimal
discretization and geographical detectors at the same time.</p>
<p><strong>The output contains all data and visualization
results.</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## install and library the pacakge</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"GD"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/ausgis/GD" class="external-link">"GD"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Example 1</span></span>
<span><span class="co">## NDVI: ndvi_40</span></span>
<span><span class="co">## set optional parameters of optimal discretization</span></span>
<span><span class="co">## optional methods: equal, natural, quantile, geometric, sd and manual</span></span>
<span><span class="va">discmethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"equal"</span>,<span class="st">"natural"</span>,<span class="st">"quantile"</span><span class="op">)</span></span>
<span><span class="va">discitv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">## "gdm" function</span></span>
<span><span class="co">## In this case, Climatezone and Mining are categorical variables,</span></span>
<span><span class="co">## and Tempchange and GDP are continuous variables.</span></span>
<span><span class="va">ndvigdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdm.html">gdm</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">Climatezone</span> <span class="op">+</span> <span class="va">Mining</span> <span class="op">+</span> <span class="va">Tempchange</span> <span class="op">+</span> <span class="va">GDP</span>,</span>
<span>               continuous_variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tempchange"</span>, <span class="st">"GDP"</span><span class="op">)</span>,</span>
<span>               data <span class="op">=</span> <span class="va">ndvi_40</span>,</span>
<span>               discmethod <span class="op">=</span> <span class="va">discmethod</span>, discitv <span class="op">=</span> <span class="va">discitv</span><span class="op">)</span> <span class="co"># ~3s</span></span>
<span><span class="va">ndvigdm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ndvigdm</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Example 2</span></span>
<span><span class="co">## H1N1: h1n1_100</span></span>
<span><span class="co">## set optional parameters of optimal discretization</span></span>
<span><span class="va">discmethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"equal"</span>,<span class="st">"natural"</span>,<span class="st">"quantile"</span>,<span class="st">"geometric"</span>,<span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="va">discitv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">continuous_variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">h1n1_100</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">## "gdm" function</span></span>
<span><span class="va">h1n1gdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdm.html">gdm</a></span><span class="op">(</span><span class="va">H1N1</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>               continuous_variable <span class="op">=</span> <span class="va">continuous_variable</span>,</span>
<span>               data <span class="op">=</span> <span class="va">h1n1_100</span>,</span>
<span>               discmethod <span class="op">=</span> <span class="va">discmethod</span>, discitv <span class="op">=</span> <span class="va">discitv</span><span class="op">)</span></span>
<span><span class="va">h1n1gdm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h1n1gdm</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="advanced-models">1.4 Advanced models<a class="anchor" aria-label="anchor" href="#advanced-models"></a>
</h3>
<p>Currently, there are the following advanced models based on spatial
stratified heterogeneity.</p>
<table class="table">
<colgroup>
<col width="35%">
<col width="64%">
</colgroup>
<thead><tr class="header">
<th align="left">Model (Publication)</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Optimal Parameters-based Geographical Detector (OPGD)
<a href="https://doi.org/10.1080/13658810802443457" class="external-link">(Song et al.,
2020)</a>
</td>
<td align="left">OPGD is used for characterising spatial heterogeneity,
identifying geographical factors and interactive impacts of factors, and
estimating risks.</td>
</tr>
<tr class="even">
<td align="left">Interactive Detector for Spatial Associations (IDSA) <a href="https://doi.org/10.1080/13658816.2021.1882680" class="external-link">(Song et al.,
2021)</a>
</td>
<td align="left">IDSA is used for estimating the power of interactive
determinants (PID) from a spatial perspective. The IDSA model considers
spatial heterogeneity, spatial autocorrelation, and spatial fuzzy
overlay of multiple explanatory variables for calculating PID.</td>
</tr>
<tr class="odd">
<td align="left">Generalized Heterogeneity Model (GHM) <a href="https://doi.org/10.1080/13658816.2022.2147530" class="external-link">(Luo et al.,
2023)</a>
</td>
<td align="left">GHM is used for characterizing local and stratified
heterogeneity within variables and to improve interpolation
accuracy.</td>
</tr>
<tr class="even">
<td align="left">Geographically Optimal Zones-based Heterogeneity (GOZH)
<a href="https://doi.org/10.1016/j.isprsjprs.2022.01.009" class="external-link">(Luo et al.,
2022)</a>
</td>
<td align="left">GOZH is used for identifying individual and interactive
determinants of geographical attributes (e.g., global soil moisture)
across a large study area. GOZH can identify optimal spatial zones and
compute the maximum power of determinant (PD) values using an
Ω-index.</td>
</tr>
<tr class="odd">
<td align="left">Robust Geographical Detector (RGD) <a href="https://doi.org/10.1016/j.jag.2022.102782" class="external-link">(Zhang et al.,
2022)</a>
</td>
<td align="left">RGD is used for the robust estimation of PD
values.</td>
</tr>
</tbody>
</table>
<p>These methods are well supported in the <a href="https://CRAN.R-project.org/package=gdverse" class="external-link">gdverse</a> package,
and we welcome you to use the <a href="https://CRAN.R-project.org/package=gdverse" class="external-link">gdverse</a> package we
developed.</p>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="geographical-detector-model">2. Geographical detector model<a class="anchor" aria-label="anchor" href="#geographical-detector-model"></a>
</h2>
<p>Spatial stratified heterogeneity can be measured using geographical
detectors (<a href="https://doi.org/10.1080/13658810802443457" class="external-link">Wang et
al. 2010</a>, <a href="https://doi.org/10.1016/j.ecolind.2016.02.052" class="external-link">Wang et
al. 2016</a>).</p>
<p>Power of determinants is computed using a <span class="math inline">\(Q\)</span>-statistic:</p>
<p><span class="math display">\[Q=1-\displaystyle \frac{\sum_{j=1}^{M}
N_{j} \sigma_{j}^2}{N \sigma^2} \]</span></p>
<p>where <span class="math inline">\(N\)</span> and <span class="math inline">\(\sigma^2\)</span> are the number and population
variance of observations within the whole study area, and <span class="math inline">\(N_{j}\)</span> and <span class="math inline">\(\sigma_{j}^2\)</span> are the number and
population variance of observations within the <span class="math inline">\(j\)</span> th (<span class="math inline">\(j\)</span>=1,…,<span class="math inline">\(M\)</span>) sub-region of an explanatory
variable.</p>
<p><strong>Please note that in <code>R</code> environment,
<code>sd</code> and <code>var</code> functions are used for computing
sample standard deviation and sample variance.</strong> If sample
variance is used in the computation, the equation of <span class="math inline">\(Q\)</span>-statistic can be converted to:</p>
<p><span class="math display">\[Q=1-\displaystyle \frac{\sum_{j=1}^{M}
(N_{j}-1) s_{j}^2}{(N-1) s^2} \]</span></p>
<p>where <span class="math inline">\(s^2\)</span> and <span class="math inline">\(s_{j}^2\)</span> are sample variance of
observations in the whole study area and in the <span class="math inline">\(j\)</span> th sub-region.</p>
<div class="float">
<img src="../reference/figures/Figure2.png" width="400" alt="Figure 1. General calculation process and relationships of functions in GD package (Song et al. 2020)"><div class="figcaption">
<strong>Figure 1</strong>. General calculation
process and relationships of functions in GD package (<a href="https://doi.org/10.1080/15481603.2020.1760434" class="external-link">Song et
al. 2020</a>)</div>
</div>
<p>Further information can be found on the <a href="https://CRAN.R-project.org/package=GD" class="external-link">manual</a> of
<strong>GD</strong> package.</p>
<p>More applications of geographical detectors are listed on <a href="http://www.geodetector.cn" class="external-link">Geodetector website</a>.</p>
<p>   </p>
</div>
<div class="section level2">
<h2 id="spatial-data-discretization">3. Spatial data discretization<a class="anchor" aria-label="anchor" href="#spatial-data-discretization"></a>
</h2>
<p>Categorical variables are required for geographical detectors, so
continuous variables should be discretized before modelling.
<strong>GD</strong> package provides two options: discretization with
given parameters, including discretization methods and numbers of
intervals, and optimal discretization with a series of optional
parameter combinations. Dataset <code>ndvi_40</code> is used as an
example for explanation.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"GD"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/ausgis/GD" class="external-link">"GD"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is GD 10.8.</span></span>
<span><span class="co">##                         </span></span>
<span><span class="co">## To cite GD in publications, please use:</span></span>
<span><span class="co">##                         </span></span>
<span><span class="co">## Song, Y., Wang, J., Ge, Y. &amp; Xu, C. (2020) An optimal parameters-based geographical detector model enhances geographic characteristics of explanatory variables for spatial heterogeneity analysis: Cases with different types of spatial data, GIScience &amp; Remote Sensing, 57(5), 593-610. doi: 10.1080/15481603.2020.1760434.</span></span>
<span><span class="co">##                         </span></span>
<span><span class="co">## If you find that GD runs for a long time without returning results, please try using the gdverse package we developed.</span></span>
<span><span class="co">## </span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ndvi_40"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ndvi_40</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   NDVIchange Climatezone Mining Tempchange Precipitation   GDP Popdensity</span></span>
<span><span class="co">## 1    0.11599         Bwk    low    0.25598        236.54 12.55    1.44957</span></span>
<span><span class="co">## 2    0.01783         Bwk    low    0.27341        213.55  2.69    0.80124</span></span>
<span><span class="co">## 3    0.13817         Bsk    low    0.30247        448.88 20.06   11.49432</span></span></code></pre>
<div class="section level3">
<h3 id="discretization-with-given-parameters-disc">3.1 Discretization with given parameters: <code>disc</code><a class="anchor" aria-label="anchor" href="#discretization-with-given-parameters-disc"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## discretization methods: equal, natural, quantile (default), geometric, sd and manual</span></span>
<span><span class="va">ds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disc.html">disc</a></span><span class="op">(</span><span class="va">ndvi_40</span><span class="op">$</span><span class="va">Tempchange</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">ds1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ds1</span><span class="op">)</span></span></code></pre></div>
<p>Further information can be found on the <a href="https://CRAN.R-project.org/package=GD" class="external-link">manual</a> of
<strong>GD</strong> package.</p>
</div>
<div class="section level3">
<h3 id="optimal-discretization-optidisc">3.2 Optimal discretization: <code>optidisc</code><a class="anchor" aria-label="anchor" href="#optimal-discretization-optidisc"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## set optional discretization methods and numbers of intervals</span></span>
<span><span class="va">discmethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"equal"</span>,<span class="st">"natural"</span>,<span class="st">"quantile"</span>,<span class="st">"geometric"</span>,<span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="va">discitv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">## optimal discretization</span></span>
<span><span class="va">odc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optidisc.html">optidisc</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">Tempchange</span>, data <span class="op">=</span> <span class="va">ndvi_40</span>,</span>
<span>                 <span class="va">discmethod</span>, <span class="va">discitv</span><span class="op">)</span></span>
<span><span class="va">odc1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">odc1</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/Figure3.png" width="600" alt="Figure 2. Process and results of optimal spatial data discretization"><div class="figcaption">
<strong>Figure 2</strong>. Process and results
of optimal spatial data discretization</div>
</div>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="geographical-detectors">4. Geographical detectors<a class="anchor" aria-label="anchor" href="#geographical-detectors"></a>
</h2>
<p><strong>GD</strong> package provides two options for geographical
detectors modelling:</p>
<ul>
<li><p>four functions are performed step by step: <code>gd</code> for
factor detector, <code>riskmean</code> and <code>gdrisk</code> for risk
detector, <code>gdinteract</code> for interaction detector and
<code>gdeco</code> for ecological detector;</p></li>
<li><p>optimal discretization and geographical detectors are performed
using a one-step function <code>gdm</code>.</p></li>
</ul>
<div class="section level3">
<h3 id="factor-detector-gd">4.1 Factor detector: <code>gd</code><a class="anchor" aria-label="anchor" href="#factor-detector-gd"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## a categorical explanatory variable</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gd.html">gd</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">Climatezone</span>, data <span class="op">=</span> <span class="va">ndvi_40</span><span class="op">)</span></span>
<span><span class="va">g1</span></span>
<span></span>
<span><span class="co">## multiple categorical explanatory variables</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gd.html">gd</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ndvi_40</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">g2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## multiple variables including continuous variables</span></span>
<span><span class="va">discmethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"equal"</span>,<span class="st">"natural"</span>,<span class="st">"quantile"</span>,<span class="st">"geometric"</span>,<span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="va">discitv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">data.ndvi</span> <span class="op">&lt;-</span> <span class="va">ndvi_40</span></span>
<span></span>
<span><span class="va">data.continuous</span> <span class="op">&lt;-</span> <span class="va">data.ndvi</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">odc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optidisc.html">optidisc</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data.continuous</span>, <span class="va">discmethod</span>, <span class="va">discitv</span><span class="op">)</span> <span class="co"># ~14s</span></span>
<span><span class="va">data.continuous</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">data.continuous</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">[</span>, <span class="va">x</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">odc1</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">itv</span><span class="op">)</span>, include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="co"># add stratified data to explanatory variables</span></span>
<span><span class="va">data.ndvi</span><span class="op">[</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">data.continuous</span></span>
<span></span>
<span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gd.html">gd</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data.ndvi</span><span class="op">)</span></span>
<span><span class="va">g3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/Figure4.png" width="300" alt="Figure 3. Results of factor detector"><div class="figcaption">
<strong>Figure 3</strong>. Results of factor
detector</div>
</div>
</div>
<div class="section level3">
<h3 id="risk-detector-riskmean-and-gdrisk">4.2 Risk detector: <code>riskmean</code> and
<code>gdrisk</code><a class="anchor" aria-label="anchor" href="#risk-detector-riskmean-and-gdrisk"></a>
</h3>
<p>Risk mean values by variables:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## categorical explanatory variables</span></span>
<span><span class="va">rm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/riskmean.html">riskmean</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">Climatezone</span> <span class="op">+</span> <span class="va">Mining</span>, data <span class="op">=</span> <span class="va">ndvi_40</span><span class="op">)</span></span>
<span><span class="va">rm1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rm1</span><span class="op">)</span></span>
<span><span class="co">## multiple variables inclusing continuous variables</span></span>
<span><span class="va">rm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/riskmean.html">riskmean</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data.ndvi</span><span class="op">)</span></span>
<span><span class="va">rm2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rm2</span><span class="op">)</span></span></code></pre></div>
<p>Risk matrix:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## categorical explanatory variables</span></span>
<span><span class="va">gr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdrisk.html">gdrisk</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">Climatezone</span> <span class="op">+</span> <span class="va">Mining</span>, data <span class="op">=</span> <span class="va">ndvi_40</span><span class="op">)</span></span>
<span><span class="va">gr1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gr1</span><span class="op">)</span></span>
<span><span class="co">## multiple variables inclusing continuous variables</span></span>
<span><span class="va">gr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdrisk.html">gdrisk</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data.ndvi</span><span class="op">)</span></span>
<span><span class="va">gr2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gr2</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/Figure5.png" width="500" alt="Figure 4. Results of risk detector"><div class="figcaption">
<strong>Figure 4</strong>. Results of risk
detector</div>
</div>
</div>
<div class="section level3">
<h3 id="interaction-detector-gdinteract">4.3 Interaction detector: <code>gdinteract</code><a class="anchor" aria-label="anchor" href="#interaction-detector-gdinteract"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## categorical explanatory variables</span></span>
<span><span class="va">gi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdinteract.html">gdinteract</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">Climatezone</span> <span class="op">+</span> <span class="va">Mining</span>, data <span class="op">=</span> <span class="va">ndvi_40</span><span class="op">)</span></span>
<span><span class="va">gi1</span></span>
<span><span class="co">## multiple variables inclusing continuous variables</span></span>
<span><span class="va">gi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdinteract.html">gdinteract</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data.ndvi</span><span class="op">)</span></span>
<span><span class="va">gi2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gi2</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/Figure6.png" width="400" alt="Figure 5. Results of interaction detector"><div class="figcaption">
<strong>Figure 5</strong>. Results of
interaction detector</div>
</div>
</div>
<div class="section level3">
<h3 id="ecological-detector-gdeco">4.4 Ecological detector: <code>gdeco</code><a class="anchor" aria-label="anchor" href="#ecological-detector-gdeco"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## categorical explanatory variables</span></span>
<span><span class="va">ge1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdeco.html">gdeco</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">Climatezone</span> <span class="op">+</span> <span class="va">Mining</span>, data <span class="op">=</span> <span class="va">ndvi_40</span><span class="op">)</span></span>
<span><span class="va">ge1</span></span>
<span><span class="co">## multiple variables inclusing continuous variables</span></span>
<span><span class="va">gd3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdeco.html">gdeco</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data.ndvi</span><span class="op">)</span></span>
<span><span class="va">gd3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gd3</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/Figure7.png" width="300" alt="Figure 6. Results of ecological detector"><div class="figcaption">
<strong>Figure 6</strong>. Results of ecological
detector</div>
</div>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="comparison-of-size-effects-of-spatial-unit">5. Comparison of size effects of spatial unit<a class="anchor" aria-label="anchor" href="#comparison-of-size-effects-of-spatial-unit"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ndvilist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ndvi_20</span>, <span class="va">ndvi_30</span>, <span class="va">ndvi_40</span>, <span class="va">ndvi_50</span><span class="op">)</span></span>
<span><span class="va">su</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">40</span>,<span class="fl">50</span><span class="op">)</span> <span class="co">## sizes of spatial units</span></span>
<span><span class="co">## "gdm" function</span></span>
<span><span class="va">gdlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ndvilist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/gdm.html">gdm</a></span><span class="op">(</span><span class="va">NDVIchange</span> <span class="op">~</span> <span class="va">Climatezone</span> <span class="op">+</span> <span class="va">Mining</span> <span class="op">+</span> <span class="va">Tempchange</span> <span class="op">+</span> <span class="va">GDP</span>,</span>
<span>      continuous_variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tempchange"</span>, <span class="st">"GDP"</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">x</span>, discmethod <span class="op">=</span> <span class="st">"quantile"</span>, discitv <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/sesu.html">sesu</a></span><span class="op">(</span><span class="va">gdlist</span>, <span class="va">su</span><span class="op">)</span> <span class="co">## size effects of spatial units</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/Figure8.png" width="350" alt="Figure 7. Spatial scale effects"><div class="figcaption">
<strong>Figure 7</strong>. Spatial scale
effects</div>
</div>
<div class="float">
<img src="../reference/figures/Figure1.png" width="300" alt="Figure 8. Overview of global research using geographical detector model (cumulative citations were updated on June 2020). (Song et al. 2020)"><div class="figcaption">
<strong>Figure 8</strong>. Overview of global
research using geographical detector model (<em>cumulative citations
were updated on June 2020</em>). (<a href="https://doi.org/10.1080/15481603.2020.1760434" class="external-link">Song et
al. 2020</a>)</div>
</div>
<p> </p>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<p>Song, Y., Wang, J.F., Ge, Y., et al. An optimal parameters-based
geographical detector model enhances geographic characteristics of
explanatory variables for spatial heterogeneity analysis: cases with
different types of spatial data. GIScience &amp; Remote Sensing, 2020.
57(5): 593-610. doi: <a href="https://doi.org/10.1080/15481603.2020.1760434" class="external-link">10.1080/15481603.2020.1760434</a>.</p>
<p>Wang, J. F., Li, X. H., Christakos, G., Liao, Y. L., et
al. Geographical detectors‐based health risk assessment and its
application in the neural tube defects study of the Heshun Region,
China. International Journal of Geographical Information Science, 2010.
24(1), 107-127. doi: <a href="https://doi.org/10.1080/13658810802443457" class="external-link">10.1080/13658810802443457</a>.</p>
<p>Wang, J. F., Zhang, T. L., &amp; Fu, B. J. A measure of spatial
stratified heterogeneity. Ecological indicators, 2016. 67, 250-256. doi:
<a href="https://doi.org/10.1016/j.ecolind.2016.02.052" class="external-link">10.1016/j.ecolind.2016.02.052</a>.</p>
<p>Luo., P., Song, Y., Zhu, D., Cheng, J., &amp; Meng, L. A generalized
heterogeneity model for spatial interpolation. International Journal of
Geographical Information Science. 2023, 37(3): 634-659. doi: <a href="https://doi.org/10.1080/13658816.2022.2147530" class="external-link">10.1080/13658816.2022.2147530</a>.</p>
<p>Guo, J., Wang, J., Xu, C., &amp; Song, Y. Modeling of spatial
stratified heterogeneity. GIScience &amp; Remote Sensing, 2020. 59(1),
1660-1677. doi: <a href="https://doi.org/10.1080/15481603.2022.2126375" class="external-link">10.1080/15481603.2022.2126375</a>.</p>
<p>Song, Y., Wu, P. An interactive detector for spatial associations.
International Journal of Geographical Information Science, 2021. doi: <a href="https://doi.org/10.1080/13658816.2021.1882680" class="external-link">10.1080/13658816.2021.1882680</a>.</p>
<p>Song, Y., Wright, G., Wu, P., Thatcher, D., et al. Segment-Based
Spatial Analysis for Assessing Road Infrastructure Performance Using
Monitoring Observations and Remote Sensing Data. Remote Sensing, 2018.
10(11): 1696. doi: <a href="https://doi.org/10.3390/rs10111696" class="external-link">10.3390/rs10111696</a>.</p>
<p>Luo, P., Song, Y., Huang, X., Ma, H., et al. Identifying determinants
of spatio-temporal disparities in soil moisture of the Northern
Hemisphere using a geographically optimal zones-based heterogeneity
model. ISPRS Journal of Photogrammetry and Remote Sensing, 2022. 185,
111-128. doi: <a href="https://doi.org/10.1016/j.isprsjprs.2022.01.009" class="external-link">10.1016/j.isprsjprs.2022.01.009</a>.</p>
<p>Zhang, Z., Song, Y., &amp; Wu, P. Robust geographical detector.
International Journal of Applied Earth Observation and Geoinformation,
2022. 109, 102782. doi: <a href="https://doi.org/10.1016/j.jag.2022.102782" class="external-link">10.1016/j.jag.2022.102782</a>.</p>
<p>Song, Y., Wu, P., Gilmore, D., et al. A Spatial Heterogeneity-Based
Segmentation Model for Analyzing Road Deterioration Network Data in
Multi-Scale Infrastructure Systems. IEEE Transactions on Intelligent
Transportation Systems, 2020. doi: <a href="https://ieeexplore.ieee.org/document/9123684" class="external-link">10.1109/TITS.2020.3001193</a>.</p>
<p>Luo, P., Song, Y. Wu, P. Spatial disparities in trade-offs: economic
and environmental impacts of road infrastructure on continental level.
GIScience &amp; Remote Sensing, 2021. doi: <a href="https://doi.org/10.1080/15481603.2021.1947624" class="external-link">10.1080/15481603.2021.1947624</a>.</p>
<p>Zhang, Z., Song, Y., Archer, N. and Wu, P. Spatial disparity of urban
performance from a scaling perspective: a study of industrial features
associated with economy, infrastructure, and innovation. GIScience &amp;
Remote Sensing. 2023. 60(1), p.2167567. doi: <a href="https://doi.org/10.1080/15481603.2023.2167567" class="external-link">10.1080/15481603.2023.2167567</a>.</p>
<p> </p>
<p>   </p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://yongzesong.com/" class="external-link">Yongze Song</a>, <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
